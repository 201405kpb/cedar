---
layout: example.hbs
---


<h1>Inlined Chart Specification</h1>

  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <style>
    #examples { height: 1800px; }
    #resizable { width: 550px; height: 150px; padding: 0.5em; }
    #resizable h3 { text-align: center; margin: 0; }
  </style>

  <div id="resizable" class="ui-widget-content">
    <div id="chart" style="height: 100%"></div>
    </div>


<script>
  //create a cedar chart
  var chart = new Cedar();

  //create the specification
  var spec ={
  "inputs":[
    {"name":"x","type":["time"], "required":true},
    {"name":"y","type":["numeric"], "required":true}
  ],
  "template":{
    "padding": "strict",
    "data": [
      {
        "name": "table",
        "url":"{data}&orderByFields={x.field}",
        "format": {"type": "json", "property": "features", "parse": {"attributes.{x.field}":"date"}}
      },
      {
        "name": "exports",
        "source": "table",
        "transform": [
          {"type": "formula", "field": "export", "expr": "datum"}
        ]
      }
    ],
    "scales": [
      {
        "name": "x",
        "type": "time",
        "range": "width",
        "nice": "month",
        "zero": false,
        "domain": {"data": "table", "field": "attributes.{x.field}"}
      },
      {
        "name": "y",
        "type": "linear",
        "range": "height",
        "nice": true,
        "domain": {"data": "table", "field": "attributes.{y.field}"}
      }
    ],
    "axes": [
      {
        "type": "x", 
        "scale": "x",
        "title": "{x.label}", 
        "properties": {
          "title": {
            "fontSize": {"value": 15},
            "fill": {"value": "#999"},
            "fontWeight": {"value": "normal"}
          },
          "ticks": {
             "stroke": {"value": "#dbdad9"}
          },
          "labels": {
            "fill": {"value": "#999"},
            "fontSize": {"value": 13}
          },
          "axis": {
             "stroke": {"value": "#dbdad9"},
             "strokeWidth": {"value": 1}
          }
        }
      },
      {
        "type": "y", 
        "scale": "y",
        "title": "{y.label}", 
        "ticks": 2,
        "properties": {
          "title": {
            "fontSize": {"value": 15},
            "fill": {"value": "#999"},
            "fontWeight": {"value": "normal"}
          },          
          "ticks": {
             "stroke": {"value": "#dbdad9"}
          },
          "labels": {
            "fill": {"value": "#999"},
            "fontSize": {"value": 13}
          },
          "axis": {
             "stroke": {"value": "#dbdad9"}
          }
        }
      }
    ],
    "marks": [
      {
        "type": "symbol",
        "from": {"data": "table"},
        "properties": {
          "enter": {
            "x": {"scale": "x", "field": "attributes.{x.field}"},
            "y": {"scale": "y", "field": "attributes.{y.field}"},
            "stroke": {"value": "#0079c1"},
            "fill": {"value": "#0079c1"},
            "size": {"value": 20},
            "fillOpacity": {
              "value": 0.8
            },
            "hover": {
              "fill": {"value": "#0079c1"},
              "size": {"value": 25}
            },
            "update": {
              "fill": {"value": "#f00"}
            }
          }
        }
      },
      {
        "type": "line",
        "from": {"data": "table"},
        "properties": {
          "enter": {
            "x": {"scale": "x", "field": "attributes.{x.field}"},
            "y": {"scale": "y", "field": "attributes.{y.field}"},
            "y2": {"scale": "y", "value": 0},
            "stroke": {"value": "#0079c1"}
          }
        }
      }
    ]
  }
}
var chart = new Cedar({"specification":spec});

  var dataset = {
    "url":"http://services.arcgis.com/bkrWlSKcjUDFDtgw/arcgis/rest/services/It's_a_Tornado_Map/FeatureServer/0",
    "mappings":{
      "x": {"field":"Date", "label": "Time"},
      "y": {"field":"Injuries", "label": "Injuries"},
      "sort":"Date"

    }
  };
  var tooltip = {
    "title": "",
    "content": "{Injuries} injuries<br/>{Fatalities} fatalities"
  };

  chart.dataset = dataset;
  //chart.dataset.mappings.sort = "DATE";
  chart.show({
    elementId: "#chart",
    autolabels: true,
    renderer: "svg"
  }); 

  chart.on('mouseover', function(event,data){
      if(data === undefined || data === null) { 
        return;
      }
      console.log("event", event)
      var cedartip = document.getElementById('cedar-tooltip');
      cedartip.style.top = event.pageY + "px";
      cedartip.style.left = event.pageX + "px";
      cedartip.style.display = "block";
      var content = "<span class='title'>" + tooltip.title + "</span><br />";
      content += "<p class='content'>" + tooltip.content + "</p>";

      cedartip.innerHTML = content.replace( /\{(\w+)\}/g, function replacer(match, $1){
        return data[$1];
      } );
    });
  chart.on('mouseout', function(event,data){
      var tooltip = document.getElementById('cedar-tooltip');
      tooltip.style.display = "none";
    })

  $(function() {
    $( "#resizable" ).resizable({
      resize: function() { chart.update(); }
    });
  });
</script>

